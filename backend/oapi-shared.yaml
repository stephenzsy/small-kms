openapi: 3.0.3
info:
  title: Small KMS Shared Models
  version: 0.1.1
paths: {}
components:
  schemas:
    CertificateRef:
      allOf:
        - $ref: "#/components/schemas/ResourceRef"
        - $ref: "#/components/schemas/CertificateRefFields"
        - x-go-type: certificateRefComposed
    CertificateRefFields:
      type: object
      properties:
        thumbprint:
          description: X.509 certificate SHA-1 thumbprint
          type: string
        subjectCommonName:
          description: Common name
          type: string
        notAfter:
          description: Expiration date of the certificate
          type: string
          format: date-time
        template:
          $ref: "#/components/schemas/ResourceLocator"
        isIssued:
          description: Whether the certificate has been issued
          type: boolean
      required:
        - thumbprint
        - subjectCommonName
        - notAfter
        - template
        - isIssued
    CertificateUsage:
      type: string
      enum:
        - ca
        - caRoot
        - serverAuth
        - clientAuth
        - keyNonExportable
      x-enum-varnames:
        - CertUsageCA
        - CertUsageCARoot
        - CertUsageServerAuth
        - CertUsageClientAuth
        - CertUsageKeyNonExportable
    Identifier:
      type: string
      x-go-type: identifierImpl
    JwkAlg:
      type: string
      enum:
        - RS256
        - RS384
        - RS512
        - ES256
        - ES384
      x-enum-varnames:
        - AlgRS256
        - AlgRS384
        - AlgRS512
        - AlgES256
        - AlgES384      
    NamespaceIdentifier:
      type: string
      x-go-type: identifierWithKind[NamespaceKind]
    NamespaceKind:
      type: string
      enum:
        - sys
        - profile
        - ca-root
        - ca-int
        - service-principal
        - group
        - device
        - user
        - application
      x-enum-varnames:
        - NamespaceKindSystem
        - NamespaceKindProfile
        - NamespaceKindCaRoot
        - NamespaceKindCaInt
        - NamespaceKindServicePrincipal
        - NamespaceKindGroup
        - NamespaceKindDevice
        - NamespaceKindUser
        - NamespaceKindApplication
    ResourceIdentifier:
      type: string
      x-go-type: identifierWithKind[ResourceKind]
    ResourceKind:
      type: string
      enum:
        - reserved
        - ca-root
        - ca-int
        - ms-graph
        - cert-template
        - cert
        - latest-cert-for-template
        - agent-config
      x-enum-varnames:
        - ResourceKindReserved
        - ResourceKindCaRoot
        - ResourceKindCaInt
        - ResourceKindMsGraph
        - ResourceKindCertTemplate
        - ResourceKindCert
        - ResourceKindLatestCertForTemplate
        - ResourceKindAgentConfig
    ResourceLocator:
      type: string
      x-go-type: locator[NamespaceKind, ResourceKind]
    ResourceRef:
      type: object
      properties:
        id:
          x-go-name: ID
          $ref: "#/components/schemas/Identifier"
        locator:
          $ref: "#/components/schemas/ResourceLocator"
        updated:
          description: Time when the resoruce was last updated
          type: string
          format: date-time
        updatedBy:
          type: string
        deleted:
          description: Time when the deleted was deleted
          type: string
          format: date-time
        metadata:
          type: object
          additionalProperties: true
          x-go-type-skip-optional-pointer: true
      required:
        - id
        - locator
    WellknownCertificateTemplateName:
      type: string
      enum:
        - default
        - default-intranet-access
        - default-ms-entra-client-creds
        - default-mtls
      x-enum-varnames:
        - CertTemplateNameDefault
        - CertTemplateNameDefaultIntranetAccess
        - CertTemplateNameDefaultMsEntraClientCreds
        - CertTemplateNameDefaultMtls
